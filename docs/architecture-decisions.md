# Architecture Decision Records (ADR)

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: sf-ai-cli-practice-v2  
**ä½œæˆæ—¥**: 2025-12-03  
**æœ€çµ‚æ›´æ–°**: 2025-12-15

---

## ğŸ“‹ ç›®æ¬¡

1. [Decision 1: Serviceå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#decision-1-serviceå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
2. [Decision 2: AI Provider](#decision-2-ai-provider)
3. [Decision 3: Query Builder](#decision-3-query-builder)
4. [Decision 4: å‘½åè¦å‰‡](#decision-4-å‘½åè¦å‰‡)
5. [Decision 5: ãƒ„ãƒ¼ãƒ«æˆ¦ç•¥ï¼ˆsfdx-hardis vs ãƒãƒ«ãƒLLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰](#decision-5-ãƒ„ãƒ¼ãƒ«æˆ¦ç•¥)


---

## Decision 1: Serviceå±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸŸ¡ æš«å®šæ±ºå®šï¼ˆPhase 2ã§å†è©•ä¾¡ï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

Salesforceé–‹ç™ºã«ãŠã‘ã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã®è¨­è¨ˆæ–¹é‡ã‚’æ±ºå®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

### é¸æŠè‚¢

#### A. fflib-apex-commonï¼ˆã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
```yaml
åˆ©ç‚¹:
  - Service/Domain/Selectorå±¤ã®æ˜ç¢ºãªåˆ†é›¢
  - UnitOfWorkãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†
  - ä¾å­˜æ€§æ³¨å…¥ï¼ˆForce-DIï¼‰
  - å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å®Ÿç¸¾

æ¬ ç‚¹:
  - å­¦ç¿’æ›²ç·šãŒæ€¥
  - å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯éå‰°
  - ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰å¢—åŠ 
```

#### B. Simple Architecture with Trigger Actions Framework
```yaml
åˆ©ç‚¹:
  - ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ã„
  - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ï¼ˆã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ä¸è¦ï¼‰
  - Flowçµ±åˆå¯èƒ½
  - å°ã€œä¸­è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«æœ€é©

æ¬ ç‚¹:
  - å¤§è¦æ¨¡åŒ–æ™‚ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å¿…è¦
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã¯æ‰‹å‹•
```

### æ±ºå®š: **B. Simple Architectureï¼ˆPhase 0-1ï¼‰**

#### ç†ç”±

1. **å€‹äººé–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º**: ç¾æ™‚ç‚¹ã§ã¯è¤‡é›‘æ€§ãŒä¸è¦
2. **å­¦ç¿’ã‚³ã‚¹ãƒˆ**: å³åº§ã«ç”Ÿç”£æ€§ã‚’ç™ºæ®å¯èƒ½
3. **æŸ”è»Ÿæ€§**: Phase 2ä»¥é™ã§fflibã¸ç§»è¡Œå¯èƒ½
4. **Trigger Actions Framework**: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é§†å‹•ã§å¤‰æ›´å®¹æ˜“

#### Phase 0-1 å®Ÿè£…æ–¹é‡

```yaml
ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£:
  Trigger Layer:
    - Apex Trigger Actions Frameworkä½¿ç”¨
    - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§ãƒãƒ³ãƒ‰ãƒ©ãƒ¼åˆ¶å¾¡
  
  Business Logic Layer:
    - ã‚·ãƒ³ãƒ—ãƒ«ãªServiceã‚¯ãƒ©ã‚¹ï¼ˆå¿…è¦æ™‚ã®ã¿ï¼‰
    - Utility/Helperã‚¯ãƒ©ã‚¹
  
  Data Access Layer:
    - Query Builderï¼ˆDecision 3ã§é¸å®šï¼‰
    - Dynamic SOQL with FLS/CRUD checks
```

#### Phase 2 å†è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆ

```yaml
fflibã¸ç§»è¡Œæ¤œè¨ã™ã‚‹æ¡ä»¶:
  - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘åŒ–ï¼ˆã‚¯ãƒ©ã‚¹æ•°50+ï¼‰
  - è¤‡æ•°é–‹ç™ºè€…ã®å”æ¥­é–‹å§‹
  - ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ•´åˆæ€§ãŒé‡è¦ã«ãªã‚‹
  - ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£å‘ä¸Šã®å¿…è¦æ€§
```

---

## Decision 2: AI Provider

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸŸ¢ æ±ºå®šï¼ˆPhase 0ï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

sfdx-hardisã®AIæ©Ÿèƒ½ï¼ˆFlow/Apexãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè‡ªå‹•ç”Ÿæˆã€ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆï¼‰ã§ä½¿ç”¨ã™ã‚‹AI Providerã‚’é¸å®šã€‚

### é¸æŠè‚¢

#### A. Anthropic Claude
```yaml
åˆ©ç‚¹:
  - sfdx-hardiså…¬å¼æ¨å¥¨
  - claude-3-5-sonnet: é«˜æ€§èƒ½
  - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé•·å¤§ï¼ˆ200K tokensï¼‰
  - ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è‰¯å¥½

æ¬ ç‚¹:
  - æ—¥æœ¬èªå¯¾å¿œã¯è‹±èªã‚ˆã‚ŠåŠ£ã‚‹ï¼ˆæ”¹å–„ä¸­ï¼‰
```

#### B. OpenAI GPT-4
```yaml
åˆ©ç‚¹:
  - é«˜å“è³ªãªæ—¥æœ¬èªå¯¾å¿œ
  - åºƒç¯„ãªçŸ¥è­˜ãƒ™ãƒ¼ã‚¹
  - è±Šå¯Œãªã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 

æ¬ ç‚¹:
  - Claudeæ¯”ã§ã‚³ã‚¹ãƒˆé«˜
  - ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé•·åˆ¶é™ï¼ˆ128K tokensï¼‰
```

#### C. Agentforceï¼ˆSalesforce AIï¼‰
```yaml
åˆ©ç‚¹:
  - Salesforceçµ±åˆ
  - ãƒ‡ãƒ¼ã‚¿ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆSalesforceå†…ï¼‰
  - Trust Layer

æ¬ ç‚¹:
  - Salesforce Foundationså¿…è¦ï¼ˆã‚³ã‚¹ãƒˆï¼‰
  - å€‹äººé–‹ç™ºã«ã¯éå‰°
```

### æ±ºå®š: **A. Anthropic Claudeï¼ˆPhase 0-2ï¼‰**

#### ç†ç”±

1. **sfdx-hardisæ¨å¥¨**: å…¬å¼ã§æœ€é©åŒ–æ¸ˆã¿
2. **ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: å€‹äººé–‹ç™ºäºˆç®—ã«é©åˆ
3. **é«˜æ€§èƒ½**: claude-3-5-sonnetã¯æœ€æ–°ä¸–ä»£
4. **å°†æ¥æ€§**: Phase 3ä»¥é™ã§Agentforceæ¤œè¨å¯å¯èƒ½

#### è¨­å®š

```yaml
# .env.local
ANTHROPIC_API_KEY=sk-ant-...
ANTHROPIC_MODEL=claude-3-5-sonnet
PROMPTS_LANGUAGE=ja
AI_MAXIMUM_CALL_NUMBER=5000

æœˆé–“ã‚³ã‚¹ãƒˆè¦‹ç©:
  ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆ: ~$5-10/æœˆ
  ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ: ~$3-5/æœˆ
  åˆè¨ˆ: ~$10-15/æœˆ
```

#### Phase 3 å†è©•ä¾¡ãƒã‚¤ãƒ³ãƒˆ

```yaml
Agentforceã¸ç§»è¡Œæ¤œè¨ã™ã‚‹æ¡ä»¶:
  - ãƒãƒ¼ãƒ 3äººä»¥ä¸Šã«æ‹¡å¤§
  - Salesforce Foundationså°å…¥
  - ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¦ä»¶å¼·åŒ–
  - æœˆé–“AIåˆ©ç”¨ã‚³ã‚¹ãƒˆ$100è¶…é
```

---

## Decision 3: Query Builder

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸ”¶ è©•ä¾¡ä¸­ï¼ˆPhase 1-2ã§æ±ºå®šï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

å‹•çš„SOQLã‚¯ã‚¨ãƒªã®æ§‹ç¯‰æ–¹æ³•ã‚’çµ±ä¸€ã—ã€ä¿å®ˆæ€§ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚

### é¸æŠè‚¢

#### A. SOQL Lib
```yaml
GitHub: beyond-the-cloud-dev/soql-lib
ç‰¹å¾´:
  - Fluent Interfaceï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ãƒã‚§ãƒ¼ãƒ³ï¼‰
  - å‹å®‰å…¨
  - ãƒ¢ãƒƒã‚¯å¯¾å¿œè‰¯å¥½
  - è»½é‡ï¼ˆä¾å­˜é–¢ä¿‚æœ€å°ï¼‰

åˆ©ç‚¹:
  - å­¦ç¿’ã‚³ã‚¹ãƒˆä½
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è‰¯å¥½
  - ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„

æ¬ ç‚¹:
  - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£å°è¦æ¨¡
  - æ©Ÿèƒ½ãŒåŸºæœ¬çš„
```

#### B. Nebula Query & Search
```yaml
GitHub: jongpie/NebulaQueryAndSearch
ç‰¹å¾´:
  - Nebulaã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ
  - FLSè‡ªå‹•ãƒã‚§ãƒƒã‚¯
  - è±Šå¯Œãªæ©Ÿèƒ½
  - è¤‡é›‘ã‚¯ã‚¨ãƒªå¯¾å¿œ

åˆ©ç‚¹:
  - ã‚»ã‚­ãƒ¥ã‚¢ï¼ˆFLSè‡ªå‹•ï¼‰
  - Nebula Loggerã¨çµ±åˆ
  - é«˜æ©Ÿèƒ½

æ¬ ç‚¹:
  - Nebulaã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜
  - å­¦ç¿’ã‚³ã‚¹ãƒˆé«˜
  - ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰
```

#### C. ApexEloquent (NEW)
```yaml
GitHub: krile136/ApexEloquent
ç‰¹å¾´:
  - Laravel Eloquentã®Apexç§»æ¤ç‰ˆ
  - Fluent Interfaceï¼ˆScribeã‚¯ãƒ©ã‚¹ï¼‰
  - MockEloquentã«ã‚ˆã‚‹DBéä¾å­˜ãƒ†ã‚¹ãƒˆ
  - ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—å‡¦ç†ã®é©æ–°ï¼ˆparent/children/throughï¼‰
  - Select-Forgotten Detection

åˆ©ç‚¹:
  - ãƒ†ã‚¹ãƒˆé€Ÿåº¦ã®åŠ‡çš„å‘ä¸Šï¼ˆæ•°ç§’ â†’ æ•°ãƒŸãƒªç§’ï¼‰
  - ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹å˜ä½“ãƒ†ã‚¹ãƒˆã®å®‰å®šåŒ–
  - è¦ªå­ãƒ»å¤šå¯¾å¤šé–¢ä¿‚ã®è¨˜è¿°ãŒç°¡æ½”
  - Laravelã‹ã‚‰ã®Webé–‹ç™ºè€…ã«ã¨ã£ã¦å­¦ç¿’å®¹æ˜“
  - ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã®é–‹ç™ºæ®µéšã§ã®æ¤œå‡º

æ¬ ç‚¹:
  - å€‹äººé–‹ç™ºãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆkrile136æ°ï¼‰
  - ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£è¦æ¨¡ä¸æ˜
  - ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒREADMEã®ã¿
  - FLS/CRUDè‡ªå‹•ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ãªã—
```

> [!IMPORTANT]
> ApexEloquentã¯ã€Œãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã€ã‚’æœ€å„ªå…ˆã™ã‚‹å ´åˆã®æœ€æœ‰åŠ›å€™è£œã€‚MockEloquentã«ã‚ˆã‚ŠDBæ“ä½œãªã—ã§ãƒ­ã‚¸ãƒƒã‚¯ã‚’é«˜é€Ÿæ¤œè¨¼ã§ãã‚‹ç‚¹ãŒæœ€å¤§ã®å·®åˆ¥åŒ–è¦å› ã€‚

### æ¯”è¼ƒãƒãƒˆãƒªã‚¯ã‚¹

| è¦³ç‚¹ | SOQL Lib | Nebula Query | ApexEloquent |
|------|----------|--------------|-------------|
| **å­¦ç¿’ã‚³ã‚¹ãƒˆ** | ä½ âœ… | ä¸­ã€œé«˜ | ä¸­ï¼ˆLaravelçµŒé¨“è€…ã¯ä½ï¼‰ |
| **ãƒ¢ãƒƒã‚­ãƒ³ã‚°** | è‰¯å¥½ | æ¨™æº–çš„ | å„ªç§€ âœ… |
| **ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨˜è¿°** | æ¨™æº–çš„ | è‰¯å¥½ | å„ªç§€ âœ… |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£** | æ‰‹å‹•FLS | è‡ªå‹•FLS âœ… | æ‰‹å‹•FLS |
| **ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ** | ãªã— | Nebula Logger | ãªã— |
| **ãƒ†ã‚¹ãƒˆé€Ÿåº¦** | æ¨™æº–çš„ | æ¨™æº–çš„ | è¶…é«˜é€Ÿ âœ… |
| **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£** | å°è¦æ¨¡ | ä¸­è¦æ¨¡ âœ… | ä¸æ˜ |
| **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹** | ã‚¢ã‚¯ãƒ†ã‚£ãƒ– | ã‚¢ã‚¯ãƒ†ã‚£ãƒ– âœ… | ä¸æ˜ |

### Phase 1-2 è©•ä¾¡è¨ˆç”»

```yaml
è©•ä¾¡æ–¹æ³•:
  1. 3ã¤å…¨ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆPhase 1ï¼‰
  2. åŒä¸€ã‚¯ã‚¨ãƒªã‚»ãƒƒãƒˆã‚’å®Ÿè£…
     ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹:
       - Accountæ¤œç´¢ï¼ˆå‹•çš„æ¡ä»¶è¤‡æ•°ï¼‰
       - è¦ªå­é–¢ä¿‚å–å¾—ï¼ˆAccount â†’ Contactsï¼‰
       - å¤šå¯¾å¤šé–¢ä¿‚ï¼ˆOrder â†’ OrderItem â†’ Product2ï¼‰
       - é›†è¨ˆã‚¯ã‚¨ãƒªï¼ˆGROUP BY + HAVINGï¼‰
  
  3. æ¯”è¼ƒè©•ä¾¡åŸºæº–
     ã‚³ãƒ¼ãƒ‰å“è³ª:
       - å¯èª­æ€§ï¼ˆã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®¹æ˜“æ€§ï¼‰
       - ä¿å®ˆæ€§ï¼ˆå¤‰æ›´æ™‚ã®å½±éŸ¿ç¯„å›²ï¼‰
     
     ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§:
       - ãƒ¢ãƒƒã‚¯ä½œæˆã®é›£æ˜“åº¦
       - ãƒ†ã‚¹ãƒˆå®Ÿè¡Œé€Ÿåº¦
       - ãƒ†ã‚¹ãƒˆã®å®‰å®šæ€§ï¼ˆFlaky Testã®å°‘ãªã•ï¼‰
     
     é‹ç”¨é¢:
       - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆå®Ÿè¡Œæ™‚ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ï¼‰
       - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆFLS/CRUDï¼‰
       - å­¦ç¿’ã‚³ã‚¹ãƒˆï¼ˆæ–°è¦ãƒ¡ãƒ³ãƒãƒ¼å‚ç”»æ™‚ï¼‰

æ±ºå®šåŸºæº–ï¼ˆPhase 2ï¼‰:
  ã‚·ãƒ³ãƒ—ãƒ«é‡è¦–: SOQL Lib
  ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£/çµ±åˆé‡è¦–: Nebula Query
  TDD/ãƒ†ã‚¹ãƒˆé€Ÿåº¦é‡è¦–: ApexEloquent
  
  è¤‡åˆæˆ¦ç•¥ã‚‚æ¤œè¨:
    - å˜ä½“ãƒ†ã‚¹ãƒˆå±¤: ApexEloquentï¼ˆãƒ¢ãƒƒã‚­ãƒ³ã‚°ï¼‰
    - çµåˆãƒ†ã‚¹ãƒˆå±¤: SOQL Lib or Nebula Queryï¼ˆå®ŸDBï¼‰
```

> [!NOTE]
> ApexEloquentã®è©³ç´°åˆ†æã¯ [sfdx-hardisã¨Apexãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¯”è¼ƒ.md](file:///Users/takashin/code/sf-ai-cli-practice-v2/docs/sfdx-hardisã¨Apexãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¯”è¼ƒ.md) ã‚’å‚ç…§ã€‚

---

## Decision 4: å‘½åè¦å‰‡

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸŸ¢ æ±ºå®šï¼ˆPhase 1ï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§çµ±ä¸€ã•ã‚ŒãŸå‘½åè¦å‰‡ãŒå¿…è¦ã€‚Salesforceã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€é …ç›®ã€Apexã€LWCã€Flowãªã©ã™ã¹ã¦ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é©ç”¨ã€‚

### é¸æŠè‚¢

#### A. Snake_Case
```yaml
ä¾‹:
  - Opportunity_Competitor__c
  - Total_Amount__c
  - Get_Lead (Flow)

åˆ©ç‚¹:
  - Salesforceãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«è¿‘ã„
  - å˜èªã®åŒºåˆ‡ã‚ŠãŒæ˜ç¢º

æ¬ ç‚¹:
  - ãƒ¢ãƒ€ãƒ³ãªé–‹ç™ºæ…£ç¿’ã¨ç•°ãªã‚‹
  - ã‚¿ã‚¤ãƒ—é‡ãŒå¢—ãˆã‚‹
```

#### B. PascalCase (Upper Camel Case)
```yaml
ä¾‹:
  - OpportunityCompetitor__c
  - TotalAmount__c
  - GetLead (Flow)

åˆ©ç‚¹:
  - ãƒ¢ãƒ€ãƒ³ãªé–‹ç™ºæ…£ç¿’ã«æº–æ‹ 
  - å¯èª­æ€§ãŒé«˜ã„
  - Apex/JavaScriptã¨ã®è¦ªå’Œæ€§
  - å¤šãã®Salesforceãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§æ¨å¥¨

æ¬ ç‚¹:
  - Salesforceãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã¨è‹¥å¹²ç•°ãªã‚‹
```

### æ±ºå®š: **B. PascalCaseï¼ˆPhase 1-ï¼‰**

#### ç†ç”±

1. **ãƒ¢ãƒ€ãƒ³ãªæ…£ç¿’**: ç¾ä»£çš„ãªé–‹ç™ºã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã«æº–æ‹ 
2. **è¨€èªé–“ã®ä¸€è²«æ€§**: Apex(PascalCase)ã€JavaScript(camelCase)ã¨ã®è¦ªå’Œæ€§
3. **å¯èª­æ€§**: å˜èªã®åŒºåˆ‡ã‚ŠãŒè¦–è¦šçš„ã«æ˜ç¢º
4. **ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹**: å¤šãã®Salesforceå°‚é–€å®¶ãŒæ¨å¥¨

#### è©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

å®Œå…¨ãªå‘½åè¦å‰‡ã¯ [development-standards.md](file:///Users/takashin/code/sf-ai-cli-practice-v2/docs/development-standards.md) ã‚’å‚ç…§

```yaml
ä¸»è¦ãƒ«ãƒ¼ãƒ«:
  ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ: OpportunityCompetitor__c
  ã‚«ã‚¹ã‚¿ãƒ é …ç›®: TotalAmount__c
  Booleané …ç›®: IsActive__c
  æ•°å¼é …ç›®: TotalRevenue_f__c
  Apexã‚¯ãƒ©ã‚¹: AccountService, ContactTriggerHandler
  Apexå¤‰æ•°: camelCase (accountName, totalCount)
  Apexå®šæ•°: UPPER_SNAKE_CASE (MAX_RECORDS)
  LWCã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ: camelCase (accountList)
  Flowè¦ç´ : Get_Account, Create_Opportunity
```

---

## Decision 5: ãƒ„ãƒ¼ãƒ«æˆ¦ç•¥

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸŸ¢ æ±ºå®šï¼ˆPhase 1ï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

sfdx-hardisï¼ˆPhase 1-2ï¼‰ã¨ãƒãƒ«ãƒLLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç’°å¢ƒï¼ˆPhase 3+ï¼‰ã®å½¹å‰²ãŒé‡è¤‡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€æ˜ç¢ºãªåˆ†æ‹…ãŒå¿…è¦ã€‚

### é¸æŠè‚¢

#### A. sfdx-hardisã®ã¿ä½¿ç”¨
```yaml
åˆ©ç‚¹:
  - ãƒ„ãƒ¼ãƒ«ã®ä¸€å…ƒåŒ–
  - å­¦ç¿’ã‚³ã‚¹ãƒˆä½æ¸›
  - å®Ÿç¸¾ã®ã‚ã‚‹ãƒ„ãƒ¼ãƒ«

æ¬ ç‚¹:
  - AIé§†å‹•ã®ã‚³ãƒ¼ãƒ‰ç”ŸæˆãŒã§ããªã„
  - ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ãŒé™å®šçš„
  - Phase 3ä»¥é™ã®ãƒ“ã‚¸ãƒ§ãƒ³å®Ÿç¾ä¸å¯
```

#### B. ãƒãƒ«ãƒLLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã¿ä½¿ç”¨
```yaml
åˆ©ç‚¹:
  - æœ€æ–°ã®AIæŠ€è¡“æ´»ç”¨
  - æŸ”è»Ÿãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
  - é•·æœŸçš„ãªãƒ“ã‚¸ãƒ§ãƒ³ã«åˆè‡´

æ¬ ç‚¹:
  - Phase 1-2ã§å®Ÿè£…ã‚³ã‚¹ãƒˆãŒé«˜ã„
  - å®‰å®šæ€§ãŒä¸ç¢ºå®Ÿ
  - ãƒ‡ãƒ—ãƒ­ã‚¤åŸºç›¤ãŒæœªæ•´å‚™
```

#### C. å½¹å‰²åˆ†æ‹…ã—ã¦ä¸¡æ–¹ä½¿ç”¨
```yaml
åˆ©ç‚¹:
  - å„ãƒ„ãƒ¼ãƒ«ã®å¼·ã¿ã‚’æ´»ç”¨
  - æ®µéšçš„ãªç§»è¡ŒãŒå¯èƒ½
  - çŸ­æœŸãƒ»é•·æœŸä¸¡æ–¹ã«å¯¾å¿œ

æ¬ ç‚¹:
  - è¤‡æ•°ãƒ„ãƒ¼ãƒ«ç®¡ç†ã®è¤‡é›‘æ€§
  - çµ±åˆã®æ‰‹é–“
```

### æ±ºå®š: **C. å½¹å‰²åˆ†æ‹…ã—ã¦ä¸¡æ–¹ä½¿ç”¨ï¼ˆPhase 1-ï¼‰**

#### ç†ç”±

1. **Short-term vs Long-term**: Phase 1-2ã¯å®Ÿç¸¾ã‚ã‚‹sfdx-hardisã€Phase 3+ã§AIçµ±åˆ
2. **è£œå®Œé–¢ä¿‚**: é‡è¤‡ã§ã¯ãªãã€äº’ã„ã‚’è£œå®Œã™ã‚‹é–¢ä¿‚
3. **æ®µéšçš„ç§»è¡Œ**: ãƒªã‚¹ã‚¯ã‚’æŠ‘ãˆãŸæ¼¸é€²çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### å½¹å‰²åˆ†æ‹…

```yaml
sfdx-hardisï¼ˆPhase 1-2ï¼‰:
  å½¹å‰²: "ç®¡ç†ã™ã‚‹ãƒ»è¨˜éŒ²ã™ã‚‹"
  ç”¨é€”:
    - CI/CDã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    - æ—¢å­˜ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æ–‡æ›¸åŒ–
    - æœªä½¿ç”¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ¤œå‡º
    - ãƒ‡ãƒ—ãƒ­ã‚¤ç®¡ç†
    - é™çš„ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆç”Ÿæˆ
  
  ç‰¹å¾´:
    - å—å‹•çš„ï¼ˆæ—¢å­˜ã®çŠ¶æ…‹ã‚’è¨˜éŒ²ï¼‰
    - å®šæœŸå®Ÿè¡Œã‚¿ã‚¹ã‚¯
    - ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…å‘ã‘

ãƒãƒ«ãƒLLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼ˆPhase 3+ï¼‰:
  å½¹å‰²: "ä½œã‚‹ãƒ»æœ€é©åŒ–ã™ã‚‹"
  ç”¨é€”:
    - æ–°è¦ã‚³ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆApex, LWCï¼‰
    - ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰è‡ªå‹•ç”Ÿæˆ
    - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Ÿè¡Œ
    - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…
    - AIãƒ‰ãƒªãƒ–ãƒ³ãªãƒ¬ãƒ“ãƒ¥ãƒ¼
  
  ç‰¹å¾´:
    - èƒ½å‹•çš„ï¼ˆæ–°ã—ã„ã‚‚ã®ã‚’å‰µé€ ï¼‰
    - è¦ä»¶é§†å‹•
    - é–‹ç™ºè€…å‘ã‘
```

#### çµ±åˆæˆ¦ç•¥

```mermaid
graph TB
    A[è¦ä»¶å®šç¾©] --> B[LLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ]
    B --> C[ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ]
    C --> D[sfdx-hardis]
    D --> E[ãƒ‡ãƒ—ãƒ­ã‚¤]
    E --> F[æœ¬ç•ªç’°å¢ƒ]
    F --> G[sfdx-hardis]
    G --> H[ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ–‡æ›¸åŒ–]
    H --> I[ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ]
    I --> B
    
    style B fill:#e1f5ff
    style G fill:#ffe1e1
```

**ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ«ãƒ¼ãƒ—:**
1. LLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
2. sfdx-hardisãŒãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»æ–‡æ›¸åŒ–
3. ç”Ÿæˆã•ã‚ŒãŸãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’LLMã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒèª­ã¿å–ã‚Š
4. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æ¬¡ã®é–‹ç™ºã«æ´»ç”¨

---

## Decision 6: ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†æˆ¦ç•¥

### ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸ”¶ è©•ä¾¡ä¸­ï¼ˆPhase 1-2ã§æ±ºå®šï¼‰

### ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ

Salesforceé–‹ç™ºã«ãŠã‘ã‚‹ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¯ã€ä»¥ä¸‹ã®2ã¤ã®ç•°ãªã‚‹èª²é¡Œã‚’æŠ±ãˆã¦ã„ã‚‹:
1. **å˜ä½“ãƒ†ã‚¹ãƒˆ**: ãƒ­ã‚¸ãƒƒã‚¯ã®æ­£ã—ã•ã‚’é«˜é€Ÿã«æ¤œè¨¼ã™ã‚‹ãŸã‚ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
2. **çµåˆãƒ†ã‚¹ãƒˆ**: å®Ÿç’°å¢ƒã«è¿‘ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã®å‹•ä½œç¢ºèª

ã“ã‚Œã‚‰ã‚’é©åˆ‡ã«ä½¿ã„åˆ†ã‘ã‚‹æˆ¦ç•¥ãŒå¿…è¦ã€‚

### ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®æ¦‚å¿µ

```yaml
ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰:
  E2Eãƒ†ã‚¹ãƒˆï¼ˆé ‚ç‚¹ï¼‰:
    - é‡: å°‘ãªã„ï¼ˆ5-10%ï¼‰
    - é€Ÿåº¦: é…ã„ï¼ˆåˆ†å˜ä½ï¼‰
    - å®‰å®šæ€§: ä½ã„ï¼ˆç’°å¢ƒä¾å­˜ï¼‰
  
  çµåˆãƒ†ã‚¹ãƒˆï¼ˆä¸­å±¤ï¼‰:
    - é‡: ä¸­ç¨‹åº¦ï¼ˆ20-30%ï¼‰
    - é€Ÿåº¦: ä¸­ç¨‹åº¦ï¼ˆç§’å˜ä½ï¼‰
    - å®‰å®šæ€§: ä¸­ç¨‹åº¦
    - ãƒ‡ãƒ¼ã‚¿: SFDMUï¼ˆå®ŸDBï¼‰
  
  å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆåŸºç›¤ï¼‰:
    - é‡: å¤šã„ï¼ˆ60-70%ï¼‰
    - é€Ÿåº¦: é«˜é€Ÿï¼ˆãƒŸãƒªç§’å˜ä½ï¼‰
    - å®‰å®šæ€§: é«˜ã„ï¼ˆç’°å¢ƒéä¾å­˜ï¼‰
    - ãƒ‡ãƒ¼ã‚¿: MockEloquentï¼ˆãƒ¡ãƒ¢ãƒªï¼‰
```

### é¸æŠè‚¢

#### A. ApexBlueprintï¼ˆãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿Factoryï¼‰

```yaml
GitHub: krile136/ApexBlueprint
ç”¨é€”: å˜ä½“ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ

åˆ©ç‚¹:
  - ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®è¨˜è¿°é‡å‰Šæ¸›
  - ApexEloquent MockEloquentã¨ã®çµ±åˆ

æ¬ ç‚¹:
  - é–‹ç™ºåˆæœŸæ®µéšï¼ˆæˆç†Ÿåº¦ä¸æ˜ï¼‰
  - ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ç¶™ç¶šæ€§ãŒä¸é€æ˜

ãƒªã‚¹ã‚¯: HIGH
```

#### B. æ‰‹å‹•Factoryãƒ‘ã‚¿ãƒ¼ãƒ³

```yaml
ç”¨é€”: å˜ä½“ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ

åˆ©ç‚¹:
  - å¤–éƒ¨ä¾å­˜ãªã—
  - å®Œå…¨ãªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«

æ¬ ç‚¹:
  - åˆæœŸå®Ÿè£…ã‚³ã‚¹ãƒˆ

ãƒªã‚¹ã‚¯: LOW
```

#### C. sfdx-hardis SFDMU

```yaml
ç”¨é€”: çµåˆãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

åˆ©ç‚¹:
  - è¦ªå­é–¢ä¿‚ç¶­æŒ
  - æœ¬ç•ªé¡ä¼¼ãƒ‡ãƒ¼ã‚¿

æ¬ ç‚¹:
  - å˜ä½“ãƒ†ã‚¹ãƒˆã«ã¯ä¸å‘ã

ãƒªã‚¹ã‚¯: LOW
```

### æ±ºå®š: **ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆ¥è¤‡åˆæˆ¦ç•¥ï¼ˆPhase 1-ï¼‰**

#### ç†ç”±

1. **ãƒ†ã‚¹ãƒˆãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®å®Ÿç¾**: å„ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«æœ€é©ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã„åˆ†ã‘ã‚‹
2. **é€Ÿåº¦ã¨ä¿¡é ¼æ€§ã®ãƒãƒ©ãƒ³ã‚¹**: é«˜é€Ÿãªå˜ä½“ãƒ†ã‚¹ãƒˆ + ä¿¡é ¼æ€§ã®é«˜ã„çµåˆãƒ†ã‚¹ãƒˆ
3. **æ®µéšçš„å°å…¥**: Phase 1ã¯æ‰‹å‹•Factoryã€Phase 2ä»¥é™ã§ApexBlueprintæ¤œè¨

#### Phaseåˆ¥æ–¹é‡

```yaml
Phase 1:
  å˜ä½“ãƒ†ã‚¹ãƒˆå±¤:
    ãƒ„ãƒ¼ãƒ«: æ‰‹å‹•Factory
    å®Ÿè£…: TestDataFactory.clsä½œæˆ
  
  çµåˆãƒ†ã‚¹ãƒˆå±¤:
    ãƒ„ãƒ¼ãƒ«: sfdx-hardis SFDMU
    å®Ÿè£…: export.jsonè¨­å®š

Phase 2:
  ApexBlueprintå°å…¥æ¤œè¨
  æ¡ä»¶:
    - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæˆç†Ÿåº¦ã®ç¢ºèª
    - ApexEloquentæ¡ç”¨ãŒç¢ºå®š
```

#### ä½¿ã„åˆ†ã‘

| ãƒ†ã‚¹ãƒˆç¨®åˆ¥ | ãƒ„ãƒ¼ãƒ« | ãƒ‡ãƒ¼ã‚¿ | é€Ÿåº¦ | ç”¨é€” |
|-----------|--------|-------|------|------|
| **å˜ä½“** | MockEloquent + Factory | ãƒ¡ãƒ¢ãƒª | ãƒŸãƒªç§’ | ãƒ­ã‚¸ãƒƒã‚¯æ¤œè¨¼ |
| **çµåˆ** | æ¨™æº–Apex + SFDMU | DB | ç§’ | é€£æºæ¤œè¨¼ |
| **E2E** | sfdx-hardis | DB | åˆ† | æœ€çµ‚ç¢ºèª |

> [!CAUTION]
> ApexBlueprintã¯é–‹ç™ºåˆæœŸæ®µéšã®ãŸã‚ã€Phase 1ã§ã¯ä¾å­˜ã‚’é¿ã‘ã€æ‰‹å‹•Factoryã§å®Ÿè£…ã€‚Phase 2ã§å†è©•ä¾¡ã€‚

---

## æ±ºå®šã®ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

| Decision | Phase 0 | Phase 1 | Phase 2 | Phase 3+ |
|----------|---------|---------|---------|----------|
| Serviceå±¤ | Simple âœ… | Simpleç¶™ç¶š | å†è©•ä¾¡ | fflibæ¤œè¨ |
| AI Provider | Claude âœ… | Claudeç¶™ç¶š | å†è©•ä¾¡ | Agentforceæ¤œè¨ |
| Query Builder | - | 3ç¨®è©•ä¾¡ ğŸ”„ | æ±ºå®š ğŸ¯ | - |
| å‘½åè¦å‰‡ | - | PascalCase âœ… | ç¶™ç¶š | ç¶™ç¶š |
| ãƒ„ãƒ¼ãƒ«æˆ¦ç•¥ | - | ä¸¡æ–¹ä½¿ç”¨ âœ… | ä¸¡æ–¹ä½¿ç”¨ | çµ±åˆå¼·åŒ– |
| Test Data | - | æ‰‹å‹•Factory âœ… | ApexBlueprintæ¤œè¨ | - |


---

## å‚è€ƒè³‡æ–™

### Development Standards
- [Development Standards & Naming Conventions](file:///Users/takashin/code/sf-ai-cli-practice-v2/docs/development-standards.md)

### Serviceå±¤
- [fflib-apex-common](https://github.com/apex-enterprise-patterns/fflib-apex-common)
- [Apex Trigger Actions Framework](https://github.com/mitchspano/apex-trigger-actions-framework)

### AI Providers
- [Anthropic Claude](https://www.anthropic.com/claude)
- [sfdx-hardis AI Guide](https://sfdx-hardis.cloudity.com/hardis/doc/ai/)

### Query Builders
- [SOQL Lib](https://github.com/beyond-the-cloud-dev/soql-lib)
- [Nebula Query & Search](https://github.com/jongpie/NebulaQueryAndSearch)
- [ApexEloquent](https://github.com/krile136/ApexEloquent)

### Test Data Management
- [ApexBlueprint](https://github.com/krile136/ApexBlueprint)
- [sfdx-hardis Data Commands](https://sfdx-hardis.cloudity.com/hardis/org/data/export/)

### Analysis Documents
- [sfdx-hardisã¨Apexãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¯”è¼ƒ](file:///Users/takashin/code/sf-ai-cli-practice-v2/docs/sfdx-hardisã¨Apexãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¯”è¼ƒ.md)

### Tools
- [sfdx-hardis Documentation](https://sfdx-hardis.cloudity.com/)


---

**æ¬¡å›æ›´æ–°**: Phase 2é–‹å§‹æ™‚ï¼ˆ2025 Q2äºˆå®šï¼‰
